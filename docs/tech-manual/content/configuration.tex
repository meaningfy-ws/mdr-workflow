\section{Configuration}
\label{sec:configuration}
The deployment suite of micro-services is defined docker-compose.yml file. At deployment and at runtime, the service configurations are provided through OS environment variables available in the \textit{.env} file. The role of the .env file is to enable the system administrators to easily change default configurations as necessary in the context of their environment.

The suite of micro-services is built, started and shut down via Makefile commands.

In order to avoid hard coding parameters, they are defined externally in the \textit{.env}. Having them in a single file makes much more sense and it is more pragmatic, as you can see and manage all parameters in one place, add the file to the version control system (the contents of the file will evolve and be in sync with the actual code) and have different files for different environments.

The file is named \textit{.env} and contains all of the parameters that you want to be able to change and that you need to build and run the defined containers. 

Having the parameters in an \textit{.env} file is very useful in a multitude of scenarios, where you would want to have different configurations for different environments where you might want to deploy. As a more specific example, consider a continuous delivery pipeline and the URLs and ports you want your containers to bind (or to connect) to. You thus can easily have two \textit{.env} files, one named \textit{test.env} and one named \textit{acceptance.env}. Each file would have the same declared variables, but with different values for each of the continuous delivery pipeline stage where itâ€™s being deployed. The benefit is that you deploy and test/use the same containers/artifacts and are able to configure them, on the spot, according to the environment that they are integrated with.

This section describes the important configurations options available for each of the services.

\subsection{RDF differ}

The RDF differ application exposes an API and an UI and depends on a dedicated triple store. The RDF diff API is the core service providing the RDF diffing functionality. The URL and port are described below, as well as the request timeout:

\begin{longtable}[c]{@{}p{3.5cm}p{3.5cm}l@{}}
	\toprule
	Description                       & Value            & Associated variable            \\* \midrule
	\endfirsthead
	%
	\multicolumn{3}{c}%
	{{\bfseries Table \thetable\ continued from previous page}}                           \\
	\endhead
	%
	\bottomrule
	\endfoot
	%
	\endlastfoot
	%
	Service URL                       & http://localhost & RDF\_DIFFER\_API\_LOCATION     \\
	Service API port                  & 4030             & RDF\_DIFFER\_API\_PORT         \\
	Is in debug mode                  & True             & RDF\_DIFFER\_DEBUG             \\
	Service UI port                   & 8030             & RDF\_DIFFER\_UI\_PORT          \\
	Web server worker process timeout & 1200             & RDF\_DIFFER\_GUNICORN\_TIMEOUT \\* \bottomrule
	\caption{RDF differ configurations}
	\label{tab:my-table1}                                                                 \\
\end{longtable}

\subsection{Configure and read logs}
Every service provided by the rdf differ has it's own log history and is configurable through the aforementioned \textit{.env} file. The current configuration accepts a relative path to where the logs to be written \textit{logs/api.log}, for example.

\subsubsection{API log example}
\begin{lstlisting}
[2021-12-01 15:54:39 +0000] [7] [INFO] Starting gunicorn 20.1.0
[2021-12-01 15:54:39 +0000] [7] [DEBUG] Arbiter booted
[2021-12-01 15:54:39 +0000] [7] [INFO] Listening at: http://0.0.0.0:4030 (7)
[2021-12-01 15:54:39 +0000] [7] [INFO] Using worker: sync
[2021-12-01 15:54:39 +0000] [9] [INFO] Booting worker with pid: 9
[2021-12-01 15:54:39 +0000] [10] [INFO] Booting worker with pid: 10
[2021-12-01 15:54:39 +0000] [7] [DEBUG] 2 workers
[2021-12-01 15:55:13 +0000] [9] [DEBUG] GET /diffs
[2021-12-01 15:55:13 +0000] [9] [DEBUG] start get diffs endpoint
[2021-12-01 15:55:13 +0000] [9] [DEBUG] finish get diffs endpoint
\end{lstlisting}

\subsubsection{UI log example}
\begin{lstlisting}
[2021-12-01 15:55:21 +0000] [10] [DEBUG] GET /tasks
[2021-12-01 15:55:21 +0000] [10] [DEBUG] request active tasks view
[2021-12-01 15:55:22 +0000] [10] [DEBUG] render active tasks view
\end{lstlisting}

The RDF differ application uses the following environment variables to define logs location:

\begin{longtable}[c]{@{}p{3.5cm}p{3.5cm}l@{}}
	\toprule
	Description & Value           & Associated variable         \\* \midrule
	\endfirsthead
	%
	\multicolumn{3}{c}%
	{{\bfseries Table \thetable\ continued from previous page}} \\
	\endhead
	%
	\bottomrule
	\endfoot
	%
	\endlastfoot
	%
	API logs    & logs/api.log    & RDF\_DIFFER\_API\_LOGS      \\
	UI logs     & logs/ui.log     & RDF\_DIFFER\_UI\_LOGS       \\
	Celery logs & logs/celery.log & RDF\_DIFFER\_CELERY\_LOGS   \\* \bottomrule
	\caption{RDF differ log configurations}
	\label{tab:rdf-differ-log}                                  \\
\end{longtable}


